<!-- Enable Mermaid.js diagrams on GitHub Pages / Just the Docs -->
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

  // Init uden auto-run; vi vil først konvertere code blocks
  mermaid.initialize({
    startOnLoad: false,
    theme: 'neutral',
    securityLevel: 'loose'
  });

  // Når siden er klar: konverter <pre><code class="language-mermaid">...</code></pre>
  // til <div class="mermaid">...</div> og kør Mermaid
  const initMermaid = () => {
    const codeBlocks = document.querySelectorAll('pre > code.language-mermaid');
    codeBlocks.forEach(code => {
      const pre = code.parentElement;
      const div = document.createElement('div');
      div.className = 'mermaid';
      // Brug textContent for at undgå HTML-escaping
      div.textContent = code.textContent;
      pre.replaceWith(div);
    });
    // Render alle .mermaid
    mermaid.run({ querySelector: '.mermaid' });
  };

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initMermaid);
  } else {
    initMermaid();
  }
</script>
